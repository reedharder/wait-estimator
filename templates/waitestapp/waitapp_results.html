{% extends 'waitestapp/base_site.html' %}
{% load static %}
{% block content %}
<div >
	<div style="padding-right:104px; padding-bottom:20px;">
		<ul class="nav nav-tabs pull-right">		  
		  <li id="scenarioTab"><a class="submitCatch" href="/waitapp/scenario/1">Scenario</a></li>		 
		  <li class="active" ><a href="#">Current Input</a></li>
		</ul>
		<br>
	</div>
 <div class="container">
		
      <!-- Main component for a primary marketing message or call to action -->
      <div class="jumbotron">
		<ul class="pager pull-right">
			<li><a class="submitPrev" href="/waitapp/6/">Previous</a></li>
			<li><a class="submitCatch" href="/waitapp/scenario/1/">Begin Scenario</a></li>
		</ul>
		<div style="display:none;">
			<a id="prevPage" href="/waitapp/6/"  style="display:none;"> PREV</a>
			<a id="nextPage" href="/waitapp/scenario/1/"  style="display:none;"> NEXT</a>
		</div>
        <h3>Current Simulation Results</h3>        
		<br>
		<div style="padding-left:25px;">
			<form>
				<label>Results for:</label>
				<select class="pageSelect">
					<option>Overall</option>
					{% for phys in phys_list %}
					<option>{{phys}}</option>
					{% endfor %}
				</select>		
			</form>
			<br>
			<div style="padding-left:25px;">
				<label> Overall estimated wait time: <span id="overallTime">N/A</span></label>
				<br><br>
				<div id="border1" style="border:1px solid black;  padding:30px;">
					<span><strong> For patient with </strong>
						<select class = "tableSelect">
									<option>0</option>
									<option>1</option>
									<option>2</option>
									<option>3+</option>
						</select> 
						<strong>chronic conditions: </strong>
					</span><br>
					<br>
					<div id="resultsTable">		
						<table><!--
							<thead>
								<tr>
									<th data-field="gender" ></th>
									<th data-field="age"></th>
									<th data-field="visit"></th>   
									<th data-field="estwait"></th>
									<th data-field="percwait"></th>
								</tr> 
							</thead>-->
							<tbody>
							<tr>
								<td></td>
								<td>Gender</td>
								<td>Age Group</td>
								<td>Visit Type</td>   
								<td>Est. Wait Time (days)</td>
								<td>
									<select class="colSelect">
										<option title="100">100% of Patients wait less than:</option>
										<option title="99">99% of Patients wait less than:</option>
										<option title="95">95% of Patients wait less than:</option>
									</select>
								</td>
							</tr>
							 <tr class="row" title="rowSelect age1">
								<td>
									<select class="rowSelect age1">
										<option>M</option>
										<option>F</option>
									</select>
								</td>
								<td>0-14</td>
								<td>
									<select class="rowSelect age1">
										<option>Preventative</option>
										<option>Acute</option>
										<option>Chronic</option>
									</select>
								</td>
								<td><div id="wait1">N/A</div></td>
								<td><div id="percentile1">N/A</div></td>
							</tr>
							<tr class="row" title="rowSelect age2">
								<td>
									<select class="rowSelect age2">
										<option>M</option>
										<option>F</option>
									</select>
								</td>
								<td>15-24</td>
								<td>
									<select class="rowSelect age2" >
										<option>Preventative</option>
										<option>Acute</option>
										<option>Chronic</option>
									</select>
								</td>
								<td><div id="wait2">N/A</div></td>
								<td><div id="percentile2">N/A</div></td>
							</tr>
							<tr class="row" title="rowSelect age3">
								<td>
									<select class="rowSelect age3">
										<option>M</option>
										<option>F</option>
									</select>
								</td>
								<td>25-44</td>
								<td>
									<select class="rowSelect age3">
										<option>Preventative</option>
										<option>Acute</option>
										<option>Chronic</option>
									</select>
								</td>
								<td><div id="wait3">N/A</div></td>
								<td><div id="percentile3">N/A</div></td>
							</tr>
							<tr class="row" title="rowSelect age4">
								<td>
									<select class="rowSelect age4">
										<option>M</option>
										<option>F</option>
									</select>
								</td>
								<td>45-64</td>
								<td>
									<select class="rowSelect age4">
										<option>Preventative</option>
										<option>Acute</option>
										<option>Chronic</option>
									</select>
								</td>
								<td><div id="wait4">N/A</div></td>
								<td><div id="percentile4">N/A</div></td>
							</tr>
							<tr class="row" title="rowSelect age5">
								<td>
									<select class="rowSelect age5">
										<option>M</option>
										<option>F</option>
									</select>
								</td>
								<td>65-74</td>
								<td>
									<select class="rowSelect age5">
										<option>Preventative</option>
										<option>Acute</option>
										<option>Chronic</option>
									</select>
								</td>
								<td><div id="wait5">N/A</div></td>
								<td><div id="percentile5">N/A</div></td>
							</tr>	
							<tr class="row" title="rowSelect age6">
								<td>
									<select class="rowSelect age6">
										<option>M</option>
										<option>F</option>
									</select>
								</td>
								<td>75+</td>
								<td>
									<select class="rowSelect age6">
										<option>Preventative</option>
										<option>Acute</option>
										<option>Chronic</option>
									</select>
								</td>
								<td><div id="wait6">N/A</div></td>
								<td><div id="percentile6">N/A</div></td>
							</tr>	
							</tbody>
						</table>
					</div>
				</div>
			<br>
			<div id="border2" style="border:1px solid black; padding:30px;">
				<label>Make results query:</label>
				<table id="queryGrid">
				 <tr>
					<td>Gender</td>
					<td>Age Range</td> 
					<td>Conditions</td>
					<td>Visit Type</td>
					<td></td>
					<td>Est. Wait Time (days)</td>
					<td>
						<select>
							<option>100% of Patients wait less than:</option>
							<option>99% of Patients wait less than:</option>
							<option>95% of Patients wait less than:</option>
						</select>
					</td>
				 </tr>
				  <tr>
					<td>
						<select class="queryOption">
							<option>M</option>
							<option>F</option>
						</select>
					</td>
					<td>
						<select class="queryOption">
							<option>0-14</option>
							<option>15-24</option>
							<option>24-44</option>
							<option>45-64</option>
							<option>65-74</option>
							<option>75+</option>
						</select>
					</td>				
					<td>
						<select class="queryOption">
							<option>0</option>
							<option>1</option>
							<option>2</option>
							<option>3+</option>
						</select>
					</td>
					<td>
						<select class="queryOption">
							<option>Preventative</option>
							<option>Acute</option>
							<option>Chronic</option>
						</select>
					</td>
					<td>
					<button id="query" style="height:30px; line-height:25px;">Submit Query</button>
					</td>
					<td><div id="queryEst">N/A</div></td>
					<td><div id="queryPerc">N/A</div></td>
				  </tr>
				 </table>
			</div>
			 <br>
			 <br>
			<!-- <div align="right" style="padding-right:40px;">
				<form action="/waitapp/scenario/1">
					<input type="submit" value="Begin Modified Scenario">
				</form>
			</div>		 -->
		
		
		
			</div>
		</div>
		
		
	</div>
</div>
</div>
<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="{% static 'js/jquery-1.11.1.min.js' %}"></script>
<script src="{% static 'js/bootstrap.min.js' %}"></script>
<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
<script src="{% static 'js/ie10-viewport-bug-workaround.js' %}"></script>
<!-- script for file upload functionality -->    

<!-- bootstrap table script -->
<script src="{% static 'js/bootstrap-table.min.js' %}"></script>

<!--table functionality and toggle show/hide table script -->
<script language="javascript">
//row change ajax call
$('.rowSelect').on('change', function() {
	//get class of row
	var rowclass = $(this).attr('class');
	
	//filter out age class 
	rowclass = "." + rowclass.split(" ")[1]
	
	//get row/agegroup
	row = rowclass.slice(-1);	
	//get array of gender and visit type
	var params= $(rowclass).map(function() {
		return $(this).val();
	}).get();
	var ansid = "#wait" + row	
	chron_cond = $('.tableSelect').val()
	doc = $('.pageSelect').val()
	$(ansid).text(params.toString() + "_" + row + chron_cond + doc)
});



$('.tableSelect').on('change', function() {
	var chron_cond = $('.tableSelect').val()
	var doc = $('.pageSelect').val()
	//loopthrough rows of table, query information
	$('.row').each( function() {
		//get row class stored in tr title
		var rowclass = $(this).attr('title');	
		//filter out age class 
		rowclass = "." + rowclass.split(" ")[1]	
		//get row/agegroup
		row = rowclass.slice(-1);	
		//get array of gender and visit type
		var params= $(rowclass).map(function() {
			return $(this).val();
		}).get();
		var ansid = "#wait" + row				
		$(ansid).text(params.toString() + "_" + row + chron_cond + doc)
	});
});


$('.pageSelect').on('change', function() {
	var doc = $('.pageSelect').val();
	var chron_cond = $('.tableSelect').val();
	
	$('#overallTime').text(doc);
	//loopthrough rows of table, query information
	$('.row').each( function() {
		//get row class stored in tr title
		var rowclass = $(this).attr('title');	
		//filter out age class 
		rowclass = "." + rowclass.split(" ")[1]	
		//get row/agegroup
		row = rowclass.slice(-1);	
		//get array of gender and visit type
		var params= $(rowclass).map(function() {
			return $(this).val();
		}).get();
		var ansid = "#wait" + row				
		$(ansid).text(params.toString() + "_" + row + chron_cond + doc)
	});
});

$('.colSelect').on('change', function() {
	
	var doc = $('.pageSelect').val();
	var chron_cond = $('.tableSelect').val();
	var perc = $('.colSelect option:selected').attr('title')
	//loopthrough rows of table, query information
	$('.row').each( function() {
		//get row class stored in tr title
		var rowclass = $(this).attr('title');	
		//filter out age class 
		rowclass = "." + rowclass.split(" ")[1]	
		//get row/agegroup
		row = rowclass.slice(-1);	
		//get array of gender and visit type
		var params= $(rowclass).map(function() {
			return $(this).val();
		}).get();
		var ansid = "#percentile" + row				
		$(ansid).text(params.toString() + "_" + row + chron_cond + "_" + perc)
	});
});

//button to submit qery action
$('#query').click( function() {
	var qParams= $('.queryOption').map(function() {
				return $(this).val();}).get();	
	$('#queryEst').text(qParams.toString())
	$('#queryPerc').text(qParams.toString())
});
</script>

{% endblock %} 